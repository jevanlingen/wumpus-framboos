<section class="users" [class.finished]="isFinished">
    <h3>Players</h3>
    <table class="user-table">
        <thead>
            <tr>
                <th>#</th>
                <th>Name</th>
                <th>Avatar</th>
                <th>Score</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            @for (score of sortedScores(); track score.username; let idx = $index;) {
            <tr>
                <td>{{idx + 1}}</td>
                <td>{{score.username}}</td>
                <td style="display: flex; vertical-align: top;">
                    <app-avatar [trouserColor]="score.trouserColor" [skinColor]="score.skinColor" />

                    @if(getGameUserState(score.userId)?.gameCompleted){
                    ✅
                    } @else if (getGameUserState(score.userId)?.death) {
                    ☠️
                    } @else if (getGameUserState(score.userId)?.hasTreasure){
                    <app-treasure style="height: 20px;" />
                    }
                </td>
                <td>{{getGameUserState(score.userId)?.points}}</td>
                <td>{{score.points}}</td>
            </tr>
            } @empty {
            <tr>
                <td colspan="3">No users in game</td>
            </tr>
            }
        </tbody>
    </table>
</section>

@if (!isFinished) {
<section class="game">
    <div>
        <h3 id="game-header">{{gameInformation()?.name}} ({{currentGameNumber
            }} / {{numberOfGames}}) <button (click)="advance()">{{isFinalGame ? 'Finish' :
                'Advance'}}</button></h3>

        @if(gameInformation(); as game){
        <app-game-grid [game]="game" />
        }
    </div>
</section>
}
